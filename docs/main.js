(()=>{"use strict";new(function(){function t(){var t=this;this.options={color:"black",lineWidth:2},this.root=null,this.canvas=null,this.context=null,this.seletedColor=this.options.color,this.lineWidth=this.options.lineWidth,this.drawingFromX=null,this.drawingFromY=null,this.drawingToX=null,this.drawingToY=null,this.mouseDown=!1,this.addListeners=function(){document.addEventListener("DOMContentLoaded",(function(){console.log("LOADED"),t.root=document.body,t.canvas=t.getCanvas(),t.context=t.getContext();var n=t;[].forEach.call(document.querySelectorAll(".bottone"),(function(t){t.addEventListener("click",(function(t){var o=this.id,e=o.match(/[A-Z][a-z]+/g);"bottoneCancella"==o?n.clarCanvas():n.changeColor(e[0])}))}))}))},console.log("Drawing constructor"),this.addListeners()}return t.prototype.changeColor=function(t){this.seletedColor=t},t.prototype.clarCanvas=function(){confirm("Sei sicuro di voler cancellare tutto?")&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.getCanvas=function(){var t=this;if(null!=this.canvas)return this.canvas;var n=document.getElementById("controls").offsetHeight;return this.canvas=document.createElement("canvas"),this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight-n-20,this.root.prepend(this.canvas),this.canvas.addEventListener("mousemove",(function(n){t.computeDrawCoordinates(n)})),this.canvas.addEventListener("mouseup",(function(n){t.computeDrawCoordinates(n)})),this.canvas.addEventListener("mousedown",(function(n){t.computeDrawCoordinates(n)})),this.canvas.addEventListener("mouseout",(function(n){t.computeDrawCoordinates(n)})),this.canvas},t.prototype.computeDrawCoordinates=function(t){switch(t.type){case"mousemove":this.mouseDown&&(this.drawingToX=t.clientX-this.canvas.offsetLeft,this.drawingToY=t.clientY-this.canvas.offsetTop,this.draw(),this.drawingFromX=this.drawingToX,this.drawingFromY=this.drawingToY);break;case"mousedown":this.mouseDown=!0,this.drawingFromX=t.clientX-this.canvas.offsetLeft,this.drawingFromY=t.clientY-this.canvas.offsetTop;break;case"mouseup":case"mouseout":this.mouseDown=!1}},t.prototype.draw=function(){this.context.beginPath(),this.context.strokeStyle=this.seletedColor,this.context.lineWidth=this.lineWidth,this.context.moveTo(this.drawingFromX,this.drawingFromY),this.context.lineTo(this.drawingToX,this.drawingToY),this.context.stroke(),this.context.closePath()},t.prototype.getContext=function(){return this.context||(this.context=this.getCanvas().getContext("2d")),this.context},t}())})();